Ch 11


--Display name of employee from Emp table and the department name from Dept name using the following query:
select ename, dept_name from emp inner join dept
on emp.dept_num=dept.dept_num;


--Display the product name, unit price and category name of the product which are under category 3 using the following query:
select product_name,unit_price,category_name from products inner join categories on products.category_id=categories.category_id where categories.category_id=3;


--The query to find the category name with the number of products and total price of all products under that category is:
select category_name, count(product_name) Available_product ,sum(unit_ price) Total_price from products inner join categories on products.category_id=categories.category_id group by categories.category_id;


--Now, display these given details arranged by category_name:
select category_name, count(product_name) Available_product ,sum(unit_ price) Total_price from products inner join categories on products.category_id=categories.category_id
group by categories.category_id order by category_name;


--To display the category name, product name, and the name of the supplier that supplied the product, we need to join the products, category, and supplier table. Use the following query for the same:
select category_name, product_name Available_product , company_name Supplied_by from products inner join categories on products.category_id=categories.category_id inner join suppliers
on products.supplier_id=suppliers.supplier_id;


--Instead of using a table name, we can use a table alias, as shown:
select category_name, product_name Available_product , company_name Supplied_by from products p inner join categories c on p.category_id=c.category_id inner join suppliers s on p.supplier_id=s.supplier_id;


--No employee is working in department 30. If we apply LEFT join, and the LEFT table is EMP, it will not show the record of department 30. Let us have a look at the following query:
select ename,dept_name from emp left join dept
on emp.dept_num=dept.dept_num


--The following is the query to display the order details of customers, ALFKI, HANAR, and QUICK, such as customer ID, order ID, shipper ID, and company name that shipped the order:
select customer_id , order_id , ship_via shipper_id , s.company_name Shipper_name from orders o left join shippers s on o.ship_via=s.shipper_id where customer_id in ('ALFKI','QUICK','HANAR') order by customer_id;

--The full outer join sets NULL values for each field of the table that does not contain the matching row if the rows in the joined table do not match. Refer to the following query:
select ename,dept_name from emp full outer join dept on emp.dept_num=dept.dept_num;


--To find the name of the employee along with their manager's name, we need to use the same table twice: once for the employee's name and again for the manager's name. Use the given query:
select * from emp order by eid; select e.ename, m.ename from emp e,emp m where e.manager=m.eid;


--The following query returns all subordinates of the manager with the id 3:
WITH RECURSIVE subordinates AS (
    SELECT         emp_id,         manager_id,         ename
    FROM         employees
    WHERE         emp_id = 3
    UNION
        SELECT
            e.emp_id,
            e.manager_id,
            e.ename
        FROM             employees e
        INNER JOIN subordinates s ON s.emp_id = e.manager_id
) SELECT
    *
FROM     subordinates;



